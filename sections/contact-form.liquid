{{ 'section-contact-form.css' | asset_url | stylesheet_tag }}

{%- style -%}
  .section-{{ section.id }}-padding {
    padding-top: {{ section.settings.padding_top | times: 0.75 | round: 0 }}px;
    padding-bottom: {{ section.settings.padding_bottom | times: 0.75 | round: 0 }}px;
  }

  @media screen and (min-width: 750px) {
    .section-{{ section.id }}-padding {
      padding-top: {{ section.settings.padding_top }}px;
      padding-bottom: {{ section.settings.padding_bottom }}px;
    }
  }
{%- endstyle -%}

<div class="contact-form color-{{ section.settings.color_scheme }} section-{{ section.id }}-padding{% if section.settings.background_image != blank %} contact-form--has-bg{% endif %}{% if section.settings.enable_grid_effect %} contact-form--grid-effect{% endif %}{% if section.settings.enable_animation %} contact-form--animated{% endif %}"{% if section.settings.background_image != blank %} style="background-image: url('{{ section.settings.background_image | image_url: width: 1920 }}'); background-size: cover; background-position: center; background-repeat: no-repeat;"{% endif %}>
  <div class="page-width">
    <div class="contact-form__container">
      <!-- Left Panel - Contact Information -->
      <div class="contact-form__info">
        <h2 class="contact-form__title">{{ section.settings.heading | default: 'Contact us' }}</h2>
        <p class="contact-form__subtitle">{{ section.settings.subtitle | default: 'We are available to answer your questions' }}</p>
      </div>

      <!-- Right Panel - Contact Form -->
      <div class="contact-form__form-panel">
        <div class="contact-form__form-header">
          <h3 class="contact-form__form-title">Send message</h3>
          <button class="contact-form__collapse-btn" type="button" aria-label="Collapse form">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <line x1="5" y1="12" x2="19" y2="12"></line>
            </svg>
          </button>
        </div>

        <div class="contact-form__form-content">
          {%- form 'contact', id: 'ContactForm', class: 'contact-form__form' -%}
            {%- if form.posted_successfully? -%}
              <div class="contact-form__message contact-form__message--success">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path>
                  <polyline points="22,4 12,14.01 9,11.01"></polyline>
                </svg>
                {{ 'templates.contact.form.post_success' | t }}
              </div>
            {%- elsif form.errors -%}
              <div class="contact-form__message contact-form__message--error">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <circle cx="12" cy="12" r="10"></circle>
                  <line x1="15" y1="9" x2="9" y2="15"></line>
                  <line x1="9" y1="9" x2="15" y2="15"></line>
                </svg>
                {{ 'templates.contact.form.error_heading' | t }}
                <ul class="contact-form__error-list">
                  {%- for field in form.errors -%}
                    <li>{{ form.errors.translated_fields[field] | capitalize }} {{ form.errors.messages[field] }}</li>
                  {%- endfor -%}
                </ul>
              </div>
            {%- endif -%}

            <div class="contact-form__field">
              <input
                type="text"
                id="ContactForm-subject"
                name="contact[subject]"
                class="contact-form__input"
                placeholder="Subject"
                value="{{ form.subject }}"
              >
            </div>

            <div class="contact-form__field">
              <input
                type="text"
                id="ContactForm-name"
                name="contact[name]"
                class="contact-form__input"
                placeholder="Name"
                value="{% if form.name %}{{ form.name }}{% elsif customer %}{{ customer.name }}{% endif %}"
                autocomplete="name"
              >
            </div>

            <div class="contact-form__field">
              <input
                type="email"
                id="ContactForm-email"
                name="contact[email]"
                class="contact-form__input"
                placeholder="Email"
                value="{% if form.email %}{{ form.email }}{% elsif customer %}{{ customer.email }}{% endif %}"
                autocomplete="email"
                required
                aria-required="true"
                {% if form.errors contains 'email' %}aria-invalid="true"{% endif %}
              >
            </div>

            <div class="contact-form__field">
              <input
                type="tel"
                id="ContactForm-phone"
                name="contact[phone]"
                class="contact-form__input"
                placeholder="+351910000000"
                value="{% if form.phone %}{{ form.phone }}{% elsif customer %}{{ customer.phone }}{% endif %}"
                autocomplete="tel"
                pattern="[0-9\-]*"
              >
            </div>

            <div class="contact-form__field">
              <textarea
                id="ContactForm-message"
                name="contact[message]"
                class="contact-form__textarea"
                placeholder="Message"
                rows="5"
              >{{ form.message }}</textarea>
            </div>

            <div class="contact-form__radio-group">
              <div class="contact-form__radio-option">
                <input
                  type="radio"
                  id="ContactForm-type-enterprise"
                  name="contact[type]"
                  value="Enterprise"
                  class="contact-form__radio"
                  checked
                >
                <label for="ContactForm-type-enterprise" class="contact-form__radio-label">Enterprise</label>
              </div>
              <div class="contact-form__radio-option">
                <input
                  type="radio"
                  id="ContactForm-type-particular"
                  name="contact[type]"
                  value="Particular"
                  class="contact-form__radio"
                >
                <label for="ContactForm-type-particular" class="contact-form__radio-label">Particular</label>
              </div>
            </div>

            <div class="contact-form__checkbox">
              <input
                type="checkbox"
                id="ContactForm-gdpr"
                name="contact[gdpr]"
                class="contact-form__checkbox-input"
                required
              >
              <label for="ContactForm-gdpr" class="contact-form__checkbox-label">
                Please read and agree to <a href="#" class="contact-form__link">GDPR</a> before submitting your data.
              </label>
            </div>

            <button type="submit" class="contact-form__submit-btn">
              To send
            </button>
          {%- endform -%}
        </div>
      </div>
    </div>

    <!-- Bottom Contact Details -->
    <div class="contact-form__footer">
      <div class="contact-form__footer-item">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"></path>
          <circle cx="12" cy="10" r="3"></circle>
        </svg>
        <span>{{ section.settings.address | default: 'R da Recta de Gomil 152 4595-144 Pacos ferreira' }}</span>
      </div>
      <div class="contact-form__footer-item">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"></path>
        </svg>
        <span>{{ section.settings.phone | default: '+351 923 080 048 +351 255 405 289' }}</span>
      </div>
    </div>
  </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
  const collapseBtn = document.querySelector('.contact-form__collapse-btn');
  const formContent = document.querySelector('.contact-form__form-content');
  const contactForm = document.querySelector('.contact-form');
  
  // Handle form collapse/expand
  if (collapseBtn && formContent) {
    collapseBtn.addEventListener('click', function() {
      formContent.classList.toggle('contact-form__form-content--collapsed');
      const isCollapsed = formContent.classList.contains('contact-form__form-content--collapsed');
      
      // Update button icon
      const icon = collapseBtn.querySelector('svg');
      if (isCollapsed) {
        icon.innerHTML = '<line x1="12" y1="5" x2="12" y2="19"></line><line x1="5" y1="12" x2="19" y2="12"></line>';
      } else {
        icon.innerHTML = '<line x1="5" y1="12" x2="19" y2="12"></line>';
      }
    });
  }
  
  // Handle animations
  if (contactForm && contactForm.classList.contains('contact-form--animated')) {
    const observer = new IntersectionObserver((entries) => {
      entries.forEach(entry => {
        if (entry.isIntersecting) {
          contactForm.classList.add('contact-form--animate-in');
          
          // Add specific animation class based on settings
          const animationType = '{{ section.settings.animation_type | default: "slide-up" }}';
          contactForm.classList.add(`contact-form--animate-${animationType}`);
          
          observer.unobserve(entry.target);
        }
      });
    }, {
      threshold: 0.1,
      rootMargin: '0px 0px -50px 0px'
    });
    
    observer.observe(contactForm);
  }
  
  // Handle grid effect
  if (contactForm && contactForm.classList.contains('contact-form--grid-effect')) {
    const gridStyle = '{{ section.settings.grid_style | default: "dots" }}';
    const gridSize = '{{ section.settings.grid_size | default: 20 }}';
    
    contactForm.classList.add(`contact-form--grid-${gridStyle}`);
    
    // Update grid size dynamically
    const gridElement = contactForm.querySelector('::after');
    if (gridElement) {
      contactForm.style.setProperty('--grid-size', `${gridSize}px`);
    }
  }
  
  // Handle background image opacity
  const backgroundOpacity = '{{ section.settings.background_opacity | default: 20 }}';
  if (contactForm && contactForm.classList.contains('contact-form--has-bg')) {
    const overlay = contactForm.querySelector('::before');
    if (overlay) {
      const opacity = backgroundOpacity / 100;
      contactForm.style.setProperty('--bg-opacity', opacity);
    }
  }
});
</script>

{% schema %}
{
  "name": "Contact Form",
  "tag": "section",
  "class": "section",
  "settings": [
    {
      "type": "text",
      "id": "heading",
      "default": "Contact us",
      "label": "Heading"
    },
    {
      "type": "text",
      "id": "subtitle",
      "default": "We are available to answer your questions",
      "label": "Subtitle"
    },
    {
      "type": "text",
      "id": "address",
      "default": "R da Recta de Gomil 152 4595-144 Pacos ferreira",
      "label": "Address"
    },
    {
      "type": "text",
      "id": "phone",
      "default": "+351 923 080 048 +351 255 405 289",
      "label": "Phone Numbers"
    },
    {
      "type": "select",
      "id": "color_scheme",
      "options": [
        {
          "value": "background-1",
          "label": "Background 1"
        },
        {
          "value": "background-2",
          "label": "Background 2"
        },
        {
          "value": "inverse",
          "label": "Inverse"
        },
        {
          "value": "accent-1",
          "label": "Accent 1"
        },
        {
          "value": "accent-2",
          "label": "Accent 2"
        }
      ],
      "default": "background-1",
      "label": "Color scheme"
    },
    {
      "type": "image_picker",
      "id": "background_image",
      "label": "Background Image"
    },
    {
      "type": "image_picker",
      "id": "banner_image",
      "label": "Banner Image"
    },
    {
      "type": "range",
      "id": "background_opacity",
      "min": 0,
      "max": 100,
      "step": 5,
      "unit": "%",
      "label": "Background Image Opacity",
      "default": 20
    },
    {
      "type": "checkbox",
      "id": "enable_grid_effect",
      "default": false,
      "label": "Enable Grid Effect"
    },
    {
      "type": "select",
      "id": "grid_style",
      "options": [
        {
          "value": "dots",
          "label": "Dots"
        },
        {
          "value": "lines",
          "label": "Lines"
        },
        {
          "value": "squares",
          "label": "Squares"
        }
      ],
      "default": "dots",
      "label": "Grid Style"
    },
    {
      "type": "range",
      "id": "grid_size",
      "min": 10,
      "max": 50,
      "step": 5,
      "unit": "px",
      "label": "Grid Size",
      "default": 20
    },
    {
      "type": "checkbox",
      "id": "enable_animation",
      "default": true,
      "label": "Enable Animation Effects"
    },
    {
      "type": "select",
      "id": "animation_type",
      "options": [
        {
          "value": "fade-in",
          "label": "Fade In"
        },
        {
          "value": "slide-up",
          "label": "Slide Up"
        },
        {
          "value": "slide-left",
          "label": "Slide Left"
        },
        {
          "value": "slide-right",
          "label": "Slide Right"
        },
        {
          "value": "zoom-in",
          "label": "Zoom In"
        }
      ],
      "default": "slide-up",
      "label": "Animation Type"
    },
    {
      "type": "range",
      "id": "animation_duration",
      "min": 0.3,
      "max": 2.0,
      "step": 0.1,
      "unit": "s",
      "label": "Animation Duration",
      "default": 0.6
    },
    {
      "type": "range",
      "id": "animation_delay",
      "min": 0,
      "max": 1.0,
      "step": 0.1,
      "unit": "s",
      "label": "Animation Delay",
      "default": 0.2
    },
    {
      "type": "range",
      "id": "padding_top",
      "min": 0,
      "max": 100,
      "step": 4,
      "unit": "px",
      "label": "Padding top",
      "default": 60
    },
    {
      "type": "range",
      "id": "padding_bottom",
      "min": 0,
      "max": 100,
      "step": 4,
      "unit": "px",
      "label": "Padding bottom",
      "default": 60
    }
  ],
  "presets": [
    {
      "name": "Contact Form"
    }
  ]
}
{% endschema %}